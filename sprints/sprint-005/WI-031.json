{
  "id": "WI-031",
  "title": "Away team division assignment and active status",
  "description": "Away teams need to move between divisions between seasons (promotion/relegation) and sometimes disband or get created. Add an active/inactive status to teams so disbanded teams can be preserved for historical fixture data rather than deleted. Provide a UI for bulk division reassignment of away teams at the start of a new season. This is the 'after season copy' workflow where the admin reviews and adjusts away teams.",
  "type": "feature",
  "priority": "medium",
  "complexity": "M",
  "parallelisable": false,
  "dependencies": ["WI-030"],
  "phase": "Phase 6: Admin Tooling and Dashboard",
  "acceptance_criteria": [
    "Teams have an active/inactive status field",
    "Inactive teams are visually distinct in team lists (greyed out or badged)",
    "Inactive teams are excluded from fixture creation dropdowns",
    "Inactive teams' historical fixtures remain visible",
    "Admin can toggle a team's active status from team detail page",
    "Division reassignment available from away team detail (move to different division)",
    "Bulk division review page shows all teams grouped by division for a season",
    "Bulk review allows drag-and-drop or dropdown to move teams between divisions",
    "Changes can be previewed before confirming"
  ],
  "technical_notes": {
    "files_to_create": [
      "templates/admin/division_review.html"
    ],
    "files_to_modify": [
      "internal/models/models.go",
      "internal/admin/teams.go",
      "internal/admin/handler.go",
      "internal/admin/service_teams.go",
      "internal/admin/service_divisions.go",
      "internal/repository/team.go",
      "templates/admin/away_team_detail.html",
      "templates/admin/away_teams.html"
    ],
    "schema_changes": "Add 'active' boolean column to teams table (default true). New migration required.",
    "routes_to_add": [
      "POST /admin/league/teams/{id}/toggle-active",
      "GET /admin/league/divisions/review",
      "POST /admin/league/divisions/review"
    ],
    "approach": [
      "1. Create migration adding 'active' boolean to teams (default true)",
      "2. Update Team model to include Active field",
      "3. Update team queries to filter by active status where appropriate",
      "4. Add toggle-active handler for individual teams",
      "5. Build division review page showing all teams by division",
      "6. Allow moving teams between divisions with preview/confirm"
    ]
  },
  "testing_requirements": [
    "New migration applies cleanly",
    "Existing teams default to active",
    "Toggle active/inactive works",
    "Inactive teams excluded from fixture creation",
    "Inactive teams' old fixtures still visible",
    "Division reassignment works for individual teams",
    "Bulk review page shows correct team/division mapping",
    "Preview shows changes before applying"
  ],
  "context": {
    "user_story": "As an administrator, I want to mark teams as inactive when they disband and move teams between divisions when they're promoted or relegated, so the league structure stays accurate without losing historical data",
    "related_docs": [
      "docs/project_overview.md",
      "docs/database_reset_guide.md"
    ]
  }
}
